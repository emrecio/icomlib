<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<title>PComm Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.0.0 on Mon Jan 17 00:45:28 2000 -->
<center>
<a class="qindex"href="index.html">Main Page</a> &nbsp; <a class="qindex"href="annotated.html">Compound List</a> &nbsp; <a class="qindex"href="files.html">File List</a> &nbsp; <a class="qindex"href="headers.html">Header Files</a> &nbsp; <a class="qindex"href="sources.html">Sources</a> &nbsp; <a class="qindex"href="functions.html">Compound Members</a> &nbsp; <a class="qindex"href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>PComm  Class Reference</h1>The Primitive Communications Object. 
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="class_pcomm-include.html">pcomm.h</a>&gt;</code>
<p>
<a href="class_pcomm-members.html">List of all members.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td colspan=4><br><h2>Public Members</h2></td></tr>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top>&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#a0">PComm</a> (char *pcrDev, tcflag_t baudRate=B9600, const char *name=0)</td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>The PComm Constructor.</em> <a href="#a0">More...</a><em></em></font><br><br></td></tr>

<p>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top>&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#a1">~PComm</a> ()</td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>The PComm Destructor.</em> <a href="#a1">More...</a><em></em></font><br><br></td></tr>

<p>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top>bool&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#a2">PCOpen</a> (const char *pcrDev=PCRDEV, tcflag_t baudRate=B9600)</td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>Opens another file descriptor to the serial device.</em> <a href="#a2">More...</a><em></em></font><br><br></td></tr>

<p>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top>void&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#a3">PCClose</a> ()</td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>Closes the currently active file descriptor.</em> <a href="#a3">More...</a><em></em></font><br><br></td></tr>

<p>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top><a class="el" href="pcomm.h.html#a3">size_pc</a>&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#a4">PCTell</a> (char *)</td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>Issue a command string to the radio.</em> <a href="#a4">More...</a><em></em></font><br><br></td></tr>

<p>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top><a class="el" href="pcomm.h.html#a3">size_pc</a>&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#a5">PCAsk</a> (char *)</td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>Issue a status request from the radio.</em> <a href="#a5">More...</a><em></em></font><br><br></td></tr>

<p>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top><a class="el" href="pcomm.h.html#a3">size_pc</a>&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#a6">PCHear</a> (char *)</td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>Receive a repsonse from the radio.</em> <a href="#a6">More...</a><em></em></font><br><br></td></tr>

<p>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top><a class="el" href="pcomm.h.html#a3">size_pc</a>&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#a7">PCRawWrite</a> (char *)</td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>writes directly to the current socket.</em> <a href="#a7">More...</a><em></em></font><br><br></td></tr>

<p>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top><a class="el" href="pcomm.h.html#a3">size_pc</a>&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#a8">PCRawRead</a> (char *)</td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>reads directly from the current socket.</em> <a href="#a8">More...</a><em></em></font><br><br></td></tr>

<p>
<tr><td colspan=4><br><h2>Private Members</h2></td></tr>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top><a class="el" href="pcomm.h.html#a3">size_pc</a>&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#c0">Write</a> (char *)</td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>Internal function to write to the socket.</em> <a href="#c0">More...</a><em></em></font><br><br></td></tr>

<p>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top><a class="el" href="pcomm.h.html#a3">size_pc</a>&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#c1">Read</a> (char *)</td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>Internal function to read from the socket.</em> <a href="#c1">More...</a><em></em></font><br><br></td></tr>

<p>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top>void&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#c2">resetCall</a> ()</td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>resets the radio and port.</em> <a href="#c2">More...</a><em></em></font><br><br></td></tr>

<p>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top>void&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#c3">countCall</a> ()</td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>function to keep track on the number of calls.</em> <a href="#c3">More...</a><em></em></font><br><br></td></tr>

<p>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top>int&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#c4">callCount</a></td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>Counter for number of times the radio has been written to.</em></font><br><br></td></tr>

<p>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top>char&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#c5">callBuf</a> [256]</td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>Internal buffer for radio reset.</em></font><br><br></td></tr>

<p>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top>struct timeval*&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#c6">timeOut</a></td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>Used in the select for timeout(s).</em></font><br><br></td></tr>

<p>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top>fd_set*&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#c7">FDSet</a></td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>Socket set used in the select.</em></font><br><br></td></tr>

<p>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top>int&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#c8">retVal</a></td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>Select()'s return value.</em></font><br><br></td></tr>

<p>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top>struct termios*&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#c9">oldtio</a></td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>Stores the port's original settings.</em></font><br><br></td></tr>

<p>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top>struct termios*&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#c10">newtio</a></td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>Port settings to be applied for current session.</em></font><br><br></td></tr>

<p>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top>int&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#c11">fd</a></td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>Socket descriptor used for current session.</em></font><br><br></td></tr>

<p>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top>char&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#c12">pcrDevice</a> [256]</td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>Current serial/comm device.</em></font><br><br></td></tr>

<p>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top>tcflag_t&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#c13">pcrSpeed</a></td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>Current baud rate.</em></font><br><br></td></tr>

<p>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top>bool&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#c14">errRead</a></td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>Was there an error reading?</em></font><br><br></td></tr>

<p>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top>bool&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#c15">errWrite</a></td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>Was there an error writing?</em></font><br><br></td></tr>

<p>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top>char&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#c16">askBuf</a> [256]</td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>Buffer for sending data in PCAsk.</em></font><br><br></td></tr>

<p>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top>char&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#c17">hearBuf</a> [256]</td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>Buffer for receiving data in PCHear.</em></font><br><br></td></tr>

<p>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top>char&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#c18">writeBuf</a> [256]</td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>Buffer for writing data used in wrapper <a class="el" href="class_pcomm.html#c0">Write</a>().</em></font><br><br></td></tr>

<p>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top>char&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#c19">readBuf</a> [256]</td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>Buffer for reading data used in wrapper <a class="el" href="class_pcomm.html#c1">Read</a>().</em></font><br><br></td></tr>

<p>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top>char&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#c20">int_name</a> [256]</td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>Internal object name. <b>Warning:</b> not necessarily populated.</em></font><br><br></td></tr>

<p>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top><a class="el" href="pcomm.h.html#a3">size_pc</a>&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#c21">writeCtr</a></td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>Send bytecount used in wrapper function <a class="el" href="class_pcomm.html#c0">Write</a>().</em></font><br><br></td></tr>

<p>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top><a class="el" href="pcomm.h.html#a3">size_pc</a>&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#c22">readCtr</a></td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>Receive bytecount used in wrapper function <a class="el" href="class_pcomm.html#c1">Read</a>().</em></font><br><br></td></tr>

<p>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top><a class="el" href="pcomm.h.html#a3">size_pc</a>&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#c23">askCtr</a></td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>Receive bytecount used in PCAsk.</em></font><br><br></td></tr>

<p>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top><a class="el" href="pcomm.h.html#a3">size_pc</a>&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#c24">tellCtr</a></td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>Send bytecount used in PCTell.</em></font><br><br></td></tr>

<p>
<tr><td><img src="null.gif"></td><td><img src="null.gif"></td><td nowrap align=right valign=top><a class="el" href="pcomm.h.html#a3">size_pc</a>&nbsp;</td><td valign=top><a class="el" href="class_pcomm.html#c25">hearCtr</a></td></tr>
<tr><td><img src=null.gif></td><td><img src=null.gif></td><td></td><td><font size=-1><em>Receive bytecount used in PCHear.</em></font><br><br></td></tr>

<p>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
The Primitive Communications Object.
<p>
PComm object is the serial i/o object. It facilitates the low level grunt work for reading and writing to the serial device(s). It handles the string manipulation necessary for communication with the radio. 
<p>
Definition at line <a class="el" href="pcomm.h-source.html#l00047">47</a> of file <a class="el" href="pcomm.h-source.html">pcomm.h</a>.<hr><h2>Member Function Documentation</h2>
<a name="a0" doxytag="PComm::PComm">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
PComm::PComm (char * <em>pcrDev</em>, tcflag_t <em>baudRate</em> = B9600, const char * <em>name</em> = 0)
</b></td></tr></table>
</a>
<div class="in">

<p>
The PComm Constructor.
<p>
<dl compact><dt>
<b>Parameters: </b><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>pcrDev</em>
&nbsp;</td><td>
 name of device to be opened (char string) </td></tr>
<tr><td valign=top><em>baudRate</em>
&nbsp;</td><td>
 speed of device to be opened </td></tr>
<tr><td valign=top><em>name</em>
&nbsp;</td><td>
 internal object name (for your use)
<p>
</td></tr>
</table>
</dl>This is the easiest way to open the serial device for communications with the radio. If the serial device cannot be opened for processing the object will abort with a -1 status code to the operating system.
<p>
You must send it at least the device name which is to be opened as the first argument. Optionally, you can send it an initial <em>baudrate</em> and an internal object <em>name.</em> </div>
<a name="a1" doxytag="PComm::~PComm">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
PComm::~PComm ()
</b></td></tr></table>
</a>
<div class="in">

<p>
The PComm Destructor.
<p>
Destroys the object, and closes any open file descriptors to the serial device. It also restores any old (initial) settings to the serial device. 
<p>
Definition at line <a class="el" href="pcomm.cpp-source.html#l00062">62</a> of file <a class="el" href="pcomm.cpp-source.html">pcomm.cpp</a>.</div>
<a name="a2" doxytag="PComm::PCOpen">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
PComm::PCOpen (const char * <em>pcrDev</em> = PCRDEV, tcflag_t <em>baudRate</em> = B9600)
</b></td></tr></table>
</a>
<div class="in">

<p>
Opens another file descriptor to the serial device.
<p>
<dl compact><dt>
<b>Parameters: </b><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>pcrDev</em>
&nbsp;</td><td>
 Serial port device to be opened. </td></tr>
<tr><td valign=top><em>baudRate</em>
&nbsp;</td><td>
 Initial serial speed.
<p>
</td></tr>
</table>
</dl>Opens a file descriptor to the device <em>pcrDev</em> (which is by default your system's PCRDEV define) at the speed <em>baudRate</em> (which is by default as delinated in your termios.h set to 9600 baud).
<p>
<b>Warning:</b> You can only call this as long as the object is alive. If you do destry the object remember to call this function only after setting up the port configuration correctly.
<p>
<dl compact><dt>
<b>Returns: </b><dd>
true or false based on success value. </dl>
<p>
Definition at line <a class="el" href="pcomm.cpp-source.html#l00079">79</a> of file <a class="el" href="pcomm.cpp-source.html">pcomm.cpp</a>.</div>
<a name="a3" doxytag="PComm::PCClose">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
PComm::PCClose ()
</b></td></tr></table>
</a>
<div class="in">

<p>
Closes the currently active file descriptor.
<p>
Used in conjunction with PCOpen(...) so that you can release and regain the socket after an initialization procedure. 
<p>
Definition at line <a class="el" href="pcomm.cpp-source.html#l00173">173</a> of file <a class="el" href="pcomm.cpp-source.html">pcomm.cpp</a>.</div>
<a name="a4" doxytag="PComm::PCTell">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
PComm::PCTell (char * <em>mesg</em>)
</b></td></tr></table>
</a>
<div class="in">

<p>
Issue a command string to the radio.
<p>
<dl compact><dt>
<b>Parameters: </b><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>mesg</em>
&nbsp;</td><td>
 command string from <a class="el" href="pcrdef.h.html">pcrdef.h</a>.
<p>
</td></tr>
</table>
</dl>Sends a command to the radio via the custom made wrapper function <a class="el" href="class_pcomm.html#c0">Write</a>() . This doesnt really alter the message at all for reading and writing to the radio.
<p>
<dl compact><dt>
<b>Returns: </b><dd>
number of bytes actually written gets returned, or (-1) on error.
<p>
</dl><dl compact><dt>
<b>See also: </b><dd>
<a class="el" href="pcrdef.h.html">pcrdef.h</a> </dl>
<p>
Definition at line <a class="el" href="pcomm.cpp-source.html#l00194">194</a> of file <a class="el" href="pcomm.cpp-source.html">pcomm.cpp</a>.</div>
<a name="a5" doxytag="PComm::PCAsk">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
PComm::PCAsk (char * <em>mesg</em>)
</b></td></tr></table>
</a>
<div class="in">

<p>
Issue a status request from the radio.
<p>
<dl compact><dt>
<b>Parameters: </b><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>mesg</em>
&nbsp;</td><td>
 a query command string
<p>
</td></tr>
</table>
</dl>This function makes sure that mesg isnt empty, as well as making sure that mesg is two bytes long. Any queries sent to the radio should be the header of the information requested to be returned.
<p>
It then zero's out the ask buffer, and copies the message into the ask buffer. Then it concatenates the PCRQST command terminator, and calls <a class="el" href="class_pcomm.html#c0">Write</a>() sending it the ask buffer.
<p>
<dl compact><dt>
<b>Returns: </b><dd>
the number of bytes asked minus the PCRQST command terminator.
<p>
</dl><dl compact><dt>
<b>See also: </b><dd>
<a class="el" href="pcrdef.h.html#a0">PCRQST</a>() <a class="el" href="pcrdef.h.html">pcrdef.h</a> </dl>
<p>
Definition at line <a class="el" href="pcomm.cpp-source.html#l00217">217</a> of file <a class="el" href="pcomm.cpp-source.html">pcomm.cpp</a>.</div>
<a name="a6" doxytag="PComm::PCHear">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
PComm::PCHear (char * <em>mesg</em>)
</b></td></tr></table>
</a>
<div class="in">

<p>
Receive a repsonse from the radio.
<p>
<dl compact><dt>
<b>Parameters: </b><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>mesg</em>
&nbsp;</td><td>
 a character string long enough to hold a reply
<p>
</td></tr>
</table>
</dl>This function makes sure that mesg is pointing to a valid address (ie: is malloc'd) then it zero's out the message string and hearBuffer. It then calls <a class="el" href="class_pcomm.html#c1">Read</a>()... remembering the number of bytes read, it cuts out the end-of-command marker read in (CR-LF) and copies what it heard into the message string.
<p>
If the radio kept spitting out LF chars, it checks for the err bool.
<p>
<dl compact><dt>
<b>Returns: </b><dd>
the number of bytes read, or -1 on err.
<p>
</dl><dl compact><dt>
<b>See also: </b><dd>
<a class="el" href="pcrdef.h.html">pcrdef.h</a> </dl>
<p>
Definition at line <a class="el" href="pcomm.cpp-source.html#l00251">251</a> of file <a class="el" href="pcomm.cpp-source.html">pcomm.cpp</a>.</div>
<a name="a7" doxytag="PComm::PCRawWrite">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
PComm::PCRawWrite (char * <em>mesg</em>)
</b></td></tr></table>
</a>
<div class="in">

<p>
writes directly to the current socket.
<p>
<dl compact><dt>
<b>Parameters: </b><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>mesg</em>
&nbsp;</td><td>
 the character string which it will write
<p>
</td></tr>
</table>
</dl>Sends a command directly to the socket without any preprocessing
<p>
<dl compact><dt>
<b>Returns: </b><dd>
number of bytes actually written
<p>
</dl><dl compact><dt>
<b>See also: </b><dd>
<a class="el" href="pcrdef.h.html">pcrdef.h</a> <a class="el" href="class_pcomm.html#a8">PCRawRead</a>(char *mesg) </dl>
<p>
Definition at line <a class="el" href="pcomm.cpp-source.html#l00304">304</a> of file <a class="el" href="pcomm.cpp-source.html">pcomm.cpp</a>.</div>
<a name="a8" doxytag="PComm::PCRawRead">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
PComm::PCRawRead (char * <em>mesg</em>)
</b></td></tr></table>
</a>
<div class="in">

<p>
reads directly from the current socket.
<p>
<dl compact><dt>
<b>Parameters: </b><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>mesg</em>
&nbsp;</td><td>
 malloc'd char string big enough to hold a reply
<p>
</td></tr>
</table>
</dl>Reads directly from the socket without any preprocessing
<p>
<dl compact><dt>
<b>Returns: </b><dd>
number of bytes read. </dl><dl compact><dt>
<b>See also: </b><dd>
<a class="el" href="pcrdef.h.html">pcrdef.h</a> <a class="el" href="class_pcomm.html#a7">PCRawWrite</a>(char *mesg) </dl>
<p>
Definition at line <a class="el" href="pcomm.cpp-source.html#l00337">337</a> of file <a class="el" href="pcomm.cpp-source.html">pcomm.cpp</a>.</div>
<a name="c0" doxytag="PComm::Write">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
PComm::Write (char * <em>submesg</em>)<code> [private]</code>
</b></td></tr></table>
</a>
<div class="in">

<p>
Internal function to write to the socket.
<p>
<dl compact><dt>
<b>Parameters: </b><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>submesg</em>
&nbsp;</td><td>
 character string to write out to
<p>
</td></tr>
</table>
</dl>sends a command to the radio/socket.
<p>
It zero's out the internal class's write buffer, and copies the message passed in called submesg into the write buffer. It appends the special end-of-command marker to the write buffer, and exec's write(). Select() is used to see if we are ready to write to the socket in the FDSet.
<p>
<dl compact><dt>
<b>Returns: </b><dd>
what was actually written minus two. Since the minus two is to account for the end-of-command marker. On error we return -2
<p>
</dl><dl compact><dt>
<b>See also: </b><dd>
<a class="el" href="class_pcomm.html#c1">Read</a>() </dl>
<p>
Definition at line <a class="el" href="pcomm.cpp-source.html#l00370">370</a> of file <a class="el" href="pcomm.cpp-source.html">pcomm.cpp</a>.</div>
<a name="c1" doxytag="PComm::Read">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
PComm::Read (char * <em>submesg</em>)<code> [private]</code>
</b></td></tr></table>
</a>
<div class="in">

<p>
Internal function to read from the socket.
<p>
<dl compact><dt>
<b>Parameters: </b><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>submesg</em>
&nbsp;</td><td>
 a character string long enough to hold data
<p>
</td></tr>
</table>
</dl>It reset's the read counter, and loopbreaker. The read counter keeps track of the number of bytes read in. The loop breaker makes sure that read doesnt get stuck reading New Lines from the radio for ever and ever. Since we are ignoring newlines when we read. The radio has a tendency of sending newlines even when it has nothing to say.
<p>
it executes read() into the internal variable read buffer, and increments the loop breaker. If the number of bytes read is greater than 1, then some useful data was read in... no need to re-loop. When good data is read, it is copied into the submesg string from the read buffer. Select() will determine if the socket in FDSet is ready to read data.
<p>
<dl compact><dt>
<b>Returns: </b><dd>
If after five times, the read() read in anything less than 1, then break, and set errRead to true, while returning the number of bytes read. If after five seconds fd says that it's still not ready, then it will return, setting the read counter to a negative value.
<p>
</dl><dl compact><dt>
<b>See also: </b><dd>
<a class="el" href="class_pcomm.html#c0">Write</a>() </dl>
<p>
Definition at line <a class="el" href="pcomm.cpp-source.html#l00416">416</a> of file <a class="el" href="pcomm.cpp-source.html">pcomm.cpp</a>.</div>
<a name="c2" doxytag="PComm::resetCall">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
PComm::resetCall ()<code> [private]</code>
</b></td></tr></table>
</a>
<div class="in">

<p>
resets the radio and port.
<p>
This function reset's the radio and the port when called. It is necessary to reset the radio after a certain number of read() and write()'s. In this case we have made it after 200 write() calls.
<p>
It closes the port, and reopens the port. Zero's out the call buffer, and copy's the poweron/ecmd command strings into the call buffer. It then select()'s to see if we are ready to write to the buffer. After which it writes to the radio to tell it, that we are back online and want it to come up. Then it bzero's the call buffer and reads what the radio has to say. It loops in that mode if it received only one character of data (the radio likes to send nothing but newlines sometimes) AND the number of loops is less than 10. We dont want to get stuck there.
<p>
<b>Warning:</b> this function is necessary for the radio to operate properly under the manual update mode. If you override this function make sure to run the radio in auto-update mode.
<p>
<dl compact><dt>
<b>See also: </b><dd>
<a class="el" href="class_pcomm.html#c3">countCall</a>() </dl>
<p>
Definition at line <a class="el" href="pcomm.cpp-source.html#l00496">496</a> of file <a class="el" href="pcomm.cpp-source.html">pcomm.cpp</a>.</div>
<a name="c3" doxytag="PComm::countCall">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
PComm::countCall ()<code> [private]</code>
</b></td></tr></table>
</a>
<div class="in">

<p>
function to keep track on the number of calls.
<p>
this function keeps track of the number of calls that were sent to the radio before the last reset. it calls <a class="el" href="class_pcomm.html#c2">resetCall</a>() every 200 calls, otherwise it increments the call count.
<p>
<dl compact><dt>
<b>See also: </b><dd>
<a class="el" href="class_pcomm.html#c2">resetCall</a>() </dl>
<p>
Definition at line <a class="el" href="pcomm.cpp-source.html#l00564">564</a> of file <a class="el" href="pcomm.cpp-source.html">pcomm.cpp</a>.</div>
<hr><h2>Member Data Documentation</h2>
<a name="c4" doxytag="PComm::callCount">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
int PComm::callCount<code> [private]</code>
</b></td></tr></table>
</a>
<div class="in">

<p>
Counter for number of times the radio has been written to.
<p>

<p>
Definition at line <a class="el" href="pcomm.h-source.html#l00068">68</a> of file <a class="el" href="pcomm.h-source.html">pcomm.h</a>.</div>
<a name="c5" doxytag="PComm::callBuf">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
char PComm::callBuf[256]<code> [private]</code>
</b></td></tr></table>
</a>
<div class="in">

<p>
Internal buffer for radio reset.
<p>

<p>
Definition at line <a class="el" href="pcomm.h-source.html#l00070">70</a> of file <a class="el" href="pcomm.h-source.html">pcomm.h</a>.</div>
<a name="c6" doxytag="PComm::timeOut">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
struct timeval* PComm::timeOut<code> [private]</code>
</b></td></tr></table>
</a>
<div class="in">

<p>
Used in the select for timeout(s).
<p>

<p>
Definition at line <a class="el" href="pcomm.h-source.html#l00073">73</a> of file <a class="el" href="pcomm.h-source.html">pcomm.h</a>.</div>
<a name="c7" doxytag="PComm::FDSet">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
fd_set* PComm::FDSet<code> [private]</code>
</b></td></tr></table>
</a>
<div class="in">

<p>
Socket set used in the select.
<p>

<p>
Definition at line <a class="el" href="pcomm.h-source.html#l00075">75</a> of file <a class="el" href="pcomm.h-source.html">pcomm.h</a>.</div>
<a name="c8" doxytag="PComm::retVal">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
int PComm::retVal<code> [private]</code>
</b></td></tr></table>
</a>
<div class="in">

<p>
Select()'s return value.
<p>

<p>
Definition at line <a class="el" href="pcomm.h-source.html#l00077">77</a> of file <a class="el" href="pcomm.h-source.html">pcomm.h</a>.</div>
<a name="c9" doxytag="PComm::oldtio">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
struct termios* PComm::oldtio<code> [private]</code>
</b></td></tr></table>
</a>
<div class="in">

<p>
Stores the port's original settings.
<p>

<p>
Definition at line <a class="el" href="pcomm.h-source.html#l00079">79</a> of file <a class="el" href="pcomm.h-source.html">pcomm.h</a>.</div>
<a name="c10" doxytag="PComm::newtio">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
struct termios* PComm::newtio<code> [private]</code>
</b></td></tr></table>
</a>
<div class="in">

<p>
Port settings to be applied for current session.
<p>

<p>
Definition at line <a class="el" href="pcomm.h-source.html#l00081">81</a> of file <a class="el" href="pcomm.h-source.html">pcomm.h</a>.</div>
<a name="c11" doxytag="PComm::fd">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
int PComm::fd<code> [private]</code>
</b></td></tr></table>
</a>
<div class="in">

<p>
Socket descriptor used for current session.
<p>

<p>
Definition at line <a class="el" href="pcomm.h-source.html#l00083">83</a> of file <a class="el" href="pcomm.h-source.html">pcomm.h</a>.</div>
<a name="c12" doxytag="PComm::pcrDevice">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
char PComm::pcrDevice[256]<code> [private]</code>
</b></td></tr></table>
</a>
<div class="in">

<p>
Current serial/comm device.
<p>

<p>
Definition at line <a class="el" href="pcomm.h-source.html#l00085">85</a> of file <a class="el" href="pcomm.h-source.html">pcomm.h</a>.</div>
<a name="c13" doxytag="PComm::pcrSpeed">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
tcflag_t PComm::pcrSpeed<code> [private]</code>
</b></td></tr></table>
</a>
<div class="in">

<p>
Current baud rate.
<p>

<p>
Definition at line <a class="el" href="pcomm.h-source.html#l00087">87</a> of file <a class="el" href="pcomm.h-source.html">pcomm.h</a>.</div>
<a name="c14" doxytag="PComm::errRead">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
bool PComm::errRead<code> [private]</code>
</b></td></tr></table>
</a>
<div class="in">

<p>
Was there an error reading?
<p>

<p>
Definition at line <a class="el" href="pcomm.h-source.html#l00090">90</a> of file <a class="el" href="pcomm.h-source.html">pcomm.h</a>.</div>
<a name="c15" doxytag="PComm::errWrite">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
bool PComm::errWrite<code> [private]</code>
</b></td></tr></table>
</a>
<div class="in">

<p>
Was there an error writing?
<p>

<p>
Definition at line <a class="el" href="pcomm.h-source.html#l00092">92</a> of file <a class="el" href="pcomm.h-source.html">pcomm.h</a>.</div>
<a name="c16" doxytag="PComm::askBuf">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
char PComm::askBuf[256]<code> [private]</code>
</b></td></tr></table>
</a>
<div class="in">

<p>
Buffer for sending data in PCAsk.
<p>

<p>
Definition at line <a class="el" href="pcomm.h-source.html#l00094">94</a> of file <a class="el" href="pcomm.h-source.html">pcomm.h</a>.</div>
<a name="c17" doxytag="PComm::hearBuf">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
char PComm::hearBuf[256]<code> [private]</code>
</b></td></tr></table>
</a>
<div class="in">

<p>
Buffer for receiving data in PCHear.
<p>

<p>
Definition at line <a class="el" href="pcomm.h-source.html#l00096">96</a> of file <a class="el" href="pcomm.h-source.html">pcomm.h</a>.</div>
<a name="c18" doxytag="PComm::writeBuf">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
char PComm::writeBuf[256]<code> [private]</code>
</b></td></tr></table>
</a>
<div class="in">

<p>
Buffer for writing data used in wrapper <a class="el" href="class_pcomm.html#c0">Write</a>().
<p>

<p>
Definition at line <a class="el" href="pcomm.h-source.html#l00098">98</a> of file <a class="el" href="pcomm.h-source.html">pcomm.h</a>.</div>
<a name="c19" doxytag="PComm::readBuf">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
char PComm::readBuf[256]<code> [private]</code>
</b></td></tr></table>
</a>
<div class="in">

<p>
Buffer for reading data used in wrapper <a class="el" href="class_pcomm.html#c1">Read</a>().
<p>

<p>
Definition at line <a class="el" href="pcomm.h-source.html#l00100">100</a> of file <a class="el" href="pcomm.h-source.html">pcomm.h</a>.</div>
<a name="c20" doxytag="PComm::int_name">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
char PComm::int_name[256]<code> [private]</code>
</b></td></tr></table>
</a>
<div class="in">

<p>
Internal object name. <b>Warning:</b> not necessarily populated.
<p>

<p>
Definition at line <a class="el" href="pcomm.h-source.html#l00102">102</a> of file <a class="el" href="pcomm.h-source.html">pcomm.h</a>.</div>
<a name="c21" doxytag="PComm::writeCtr">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
<a class="el" href="pcomm.h.html#a3">size_pc</a> PComm::writeCtr<code> [private]</code>
</b></td></tr></table>
</a>
<div class="in">

<p>
Send bytecount used in wrapper function <a class="el" href="class_pcomm.html#c0">Write</a>().
<p>

<p>
Definition at line <a class="el" href="pcomm.h-source.html#l00104">104</a> of file <a class="el" href="pcomm.h-source.html">pcomm.h</a>.</div>
<a name="c22" doxytag="PComm::readCtr">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
<a class="el" href="pcomm.h.html#a3">size_pc</a> PComm::readCtr<code> [private]</code>
</b></td></tr></table>
</a>
<div class="in">

<p>
Receive bytecount used in wrapper function <a class="el" href="class_pcomm.html#c1">Read</a>().
<p>

<p>
Definition at line <a class="el" href="pcomm.h-source.html#l00106">106</a> of file <a class="el" href="pcomm.h-source.html">pcomm.h</a>.</div>
<a name="c23" doxytag="PComm::askCtr">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
<a class="el" href="pcomm.h.html#a3">size_pc</a> PComm::askCtr<code> [private]</code>
</b></td></tr></table>
</a>
<div class="in">

<p>
Receive bytecount used in PCAsk.
<p>

<p>
Definition at line <a class="el" href="pcomm.h-source.html#l00108">108</a> of file <a class="el" href="pcomm.h-source.html">pcomm.h</a>.</div>
<a name="c24" doxytag="PComm::tellCtr">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
<a class="el" href="pcomm.h.html#a3">size_pc</a> PComm::tellCtr<code> [private]</code>
</b></td></tr></table>
</a>
<div class="in">

<p>
Send bytecount used in PCTell.
<p>

<p>
Definition at line <a class="el" href="pcomm.h-source.html#l00110">110</a> of file <a class="el" href="pcomm.h-source.html">pcomm.h</a>.</div>
<a name="c25" doxytag="PComm::hearCtr">
<p><table width=100%% cellpadding=2 cellspacing=0 border=0><tr><td class="md"><b>
<a class="el" href="pcomm.h.html#a3">size_pc</a> PComm::hearCtr<code> [private]</code>
</b></td></tr></table>
</a>
<div class="in">

<p>
Receive bytecount used in PCHear.
<p>

<p>
Definition at line <a class="el" href="pcomm.h-source.html#l00112">112</a> of file <a class="el" href="pcomm.h-source.html">pcomm.h</a>.</div>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="pcomm.h.html">pcomm.h</a><li><a class="el" href="pcomm.cpp.html">pcomm.cpp</a></ul>
<hr><address><small>Generated at Mon Jan 17 00:45:29 2000 for Icom PCR-1000 Library by
<a href="http://www.stack.nl/~dimitri/doxygen/index.html">
<img src="doxygen.gif" alt="doxygen" align=center border=0 
width=118 height=53></a> 1.0.0 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy; 1997-1999</small></address>
</body>
</html>
